<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>

    <h1>TITULO</h1>
    <p>PARAGRAFO</p>
    <div>DADOS</div>

    <script>
        console.log(this); // é window

        /*
        O this de uma função é dinâmico, isto é, seu valor é determinado no 
        momento em que a função é chamada. Como o this é dinâmico, é possível 
        usar artifícios da linguagem, como a API Reflect, para alterá-lo se 
        assim desejarmos.

        O this de uma arrow function é léxico, isto é, seu valor é 
        determinado no local onde a arrow function for definida, ela 
        não cria um novo this. O this de uma arrow function não pode ser 
        alterado, mesmo se usarmos recursos da linguagem, como a API Reflect.
        */


        /*
        let exibeConteudo = function() {
            console.log(this);
            alert(this.textContent);
        };
        */

        // arrow function agora!
        let exibeConteudo = () =>  {
            console.log(this);
            alert(this.textContent);
        };

        $ = document.querySelector.bind(document);
        $('h1').addEventListener('click', exibeConteudo);
        $('p').addEventListener('click', exibeConteudo);
        $('div').addEventListener('click', exibeConteudo);

        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################

        class SistemaImpressao {

            constructor() {
                this._codigo = 2;
            }

            imprime(nomes) {
                /* Function
                nomes.forEach(function(nome) {
                    console.log(this);
                    console.log(`${this._codigo}: ${nome}`);
                });
                */

                // Arrow function
                nomes.forEach(nome => {
                    console.log(this);
                    console.log(`${this._codigo}: ${nome}`);
                });


            }
        }

        let nomes = ['Flávio', 'Nico', 'Douglas'];
        let si = new SistemaImpressao();
        si.imprime(nomes);        

        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################

        class Relogio {

            constructor() {
                
                this._segundos = 0;

                // Function
                // let self = this;
                // setInterval( function() { console.log(++self._segundos) } , 1000 );

                // Arrow function
                // setInterval( () => console.log(++this._segundos), 1000);

            }

        }

        var relogio = new Relogio();

        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################

        let carro = {
            velocidade: 100,
            acelera :function() {
                console.log(this);
                console.log(`Carro a ${this.velocidade} km por hora!`);
            },
            aceleraArrow: () => {
                console.log(this);
                console.log(`Carro a ${this.velocidade} km por hora!`);
            }
        };
        carro.acelera();
        carro.aceleraArrow();

        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################
        // ####################################################################

        let objeto1 = {
            nome: 'Bob'
        };

        let objeto2 = {
            nome: 'Leo'
        }

        function exibeNome(pref,suf) {
            alert(pref + this.nome + suf);
        }

        Reflect.apply(exibeNome, objeto1, ['(',')']); // exibe 'Bob'        

    </script>
</body>
</html>